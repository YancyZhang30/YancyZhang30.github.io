# 前端脚手架

## 常见脚手架

脚手架其实是一个使用 js 编写的 Node.js 命令行工具（CLI），里面也都是js代码，只不过用 Node.js 来执行的，还用了一些node的API而已。

脚手架就相当于是一个工具箱，里面包含许多常用的库和工具，开发人员可以通过命令行的方式快速创建项目、生成组件模板、配置开发环境等，使得开发更加高效和便捷，省去重复和繁琐的配置过程。

例如常见的vue-cli、create-react-app、vite等都是常用的脚手架。

- 如何搭建一个脚手架的工程
-如何开发和调试一个脚手架
- 脚手架中如何接收和处理命令参数
- 脚手架中如何和用户交互
- 脚手架中如何拷贝一个文件夹或文件
- 脚手架中如何动态生成一个文件
- 脚手架中如何处理路径问题
- 脚手架中如何自动安装模板所需依赖

虽然直接使用vue或者react脚手架可以快速初始化一个项目，但是其实可以发现，我们初始化项目完之后，可能还要进行eslint、husky和一些常见库的安装，
并且几乎几乎都是通用的，所以考虑在公司私有库创建一个公司通用的脚手架，这样可以大大提高创建项目的效率，避免重复的初始化项目工作。

## 脚手架命令
如果你熟悉 Vue , 肯定对 vue-cli 这个脚手架有一定了解，比如运行 vue create myapp 命令来创建一个 Vue 工程。

如果我们没有运行 npm install -g vue-cli 安装 vue-cli 脚手架，在命令行窗口中直接运行 vue create myapp，会报错。

可见 vue 不是系统命令， vue 只是 vue-cli 脚手架声明的一个命令。

## 三方库

在完善构建脚手架前，需要引入一些脚手架构建中必须用到的工具库。
- commander 可以自定义一些命令行指令，在输入自定义的命令行的时候，会去执行相应的操作。
- inquirer 可以在命令行询问用户问题，并且可以记录用户回答选择的结果。
- fs-extra 是fs的一个扩展，提供了非常多的便利API，并且继承了fs所有方法和为fs方法添加了promise的支持。
- chalk 可以美化终端的输出。
- figlet 可以在终端输出logo。
- ora 控制台的loading动画。
- download-git-repo 下载远程模板。

```bash
npm install commander@9.0.0 chalk@4.0.0 download-git-repo ora inquirer@8.2.1 figlet@1.5.2 --save
```
## 完成脚手架
[![pPDnZzF.md.png](https://s1.ax1x.com/2023/09/03/pPDnZzF.png)](https://s1.ax1x.com/2023/09/03/pPDnZzF.png)

我专门去看了一下公司的公共脚手架mpaas-cli源码。

大致流程就是使用mpaas-cli命令时，就会运行index.ts脚本内容，让用户输入项目名称，然后选择项目模板，也就是template中的三个模板，
然后将模板文件复制到当前项目文件夹，也就完成了项目的初始化，有的脚手架模板是通过直接从git仓库中远程下载的。

其中的详细逻辑和代码还要再钻研一下。
## npm link
使用`npm link`命令可以将本地的npm包链接到项目中进行调试，不需要发布后调试。
1. 进入本地npm包目录

2. 在本地npm包目录中执行npm link命令：运行npm link命令，它会将当前目录中的`npm包注册到全局npm模块目录`中。

3. 进入本地项目目录。

4. 在项目目录中执行npm link命令：运行npm link 包名命令，将全局npm模块目录中的本地npm包链接到项目中。
```shell
npm link 包名
```
5. 注意将"包名"替换为你要调试的npm包的实际名称，此时，你的本地npm包已经成功链接到了项目中。

现在，可以在项目中对已链接的本地npm包进行调试和修改。当你对本地npm包的代码进行了更改时，无需重新运行npm link命令，修改会立即生效。
当完成本地npm包调试后，记得将链接断开。在项目目录中执行以下命令取消链接：
```shell
npm unlink 包名
```
这将取消项目与本地npm包之间的链接。

所以我们在开发脚手架之后，需要本地调试，那么在脚手架根目录下npm link，就可以在全局环境中试用脚手架创建模板项目了。